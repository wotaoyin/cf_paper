% !TEX root = ./amsa_main.tex
\subsubsection{Empirical Risk Minimization}
We consider the following regularized empirical risk minimization problem
\begin{equation}\label{prob:erm}
\Min_{x\in\RR^m}~ \frac{1}{p}\sum_{j=1}^p\phi_j(a_j^\top x)+f(x)+g(x),
\end{equation}
where $a_j$'s are sample vectors, $\phi_j$'s are loss functions, and $f+g$ is a regularization function, where $f$ is differentiable and $g$ is proximable. The problem aims to learn a response vector $x$ from $a_j$'s so that the total loss measured by $\sum_j \phi_j$ is small. When prior information about $x$ such as sparsity is provided, it is modeled with a regularization function $f+g$ such that the prior information is kept by small value of $f(x)+g(x)$. The need for coordinate update algorithms arise in  the many applications of \eqref{prob:erm} where there are a very large number of samples, namely, $p\gg m$. 

We define $A=[a_1,a_2,...,a_p]^\top$, with $a_i$ being the $i$th row of $A$, and $h(y):=\frac{1}{p}\sum_{i=1}^p\phi_i(y_i)$ . Hence, $h(Ax)=\frac{1}{n}\sum_{i=1}^p\phi_i(a_i^\top x)$, and the problem \eqref{prob:erm} reduces to the form \eqref{pdproblem}.
We can apply the primal-dual update scheme~\eqref{vucondat2} to solve this problem, for which we introduce the dual variable $s = (s_1, ..., s_p)^\top$. Since $p\gg m$, we use $1+p$ coordinates, where the $0$th coordinate is $x\in\RR^m$ and the $j$th coordinate is $s_j$, $j=1,\ldots,p$.  Each iteration, a coordinate is updated:
\begin{equation}
{\left\{
\begin{array}{l}
\text{if }x\text{ is chosen, then compute}\\
\qquad {x}^{k+1}=\prox_{\eta g}(x^k-\eta(\nabla f(x^k)+A^\top s^k))\\
\text{if }s_j\text{ is chosen, then compute}\\
\qquad\tilde{x}^{k+1}=\prox_{\eta g}(x^k-\eta(\nabla f(x^k)+A^\top s^k))\\
\qquad\text{and}\\
\qquad{s}_j^{k+1}=\frac{1}{n}\prox_{n\gamma \phi_j^*} (ns_j^k+n\gamma a_j^\top(2\tilde{x}^{k+1}-x^k)).
\end{array}
\right.
}\end{equation}

We maintain $A^\top s\in \RR^m$ in the memory. Depending on the structure of $\nabla f$, we can compute it each time or maintain it. When $\prox_g\in\cF_1$, we can further apply  coordinate updates to $x_i$. 
